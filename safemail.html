<!DOCTYPE html>
<html>
<body>
<style>
  body {
    background-color: black;
    color: white;
  }
</style>
<noscript>If this text is visible, you disabled JavaScript, meaning that you probably went here by accident. If this was an accident, please leave.</noscript>
<script>
// Parse the URL parameters
const urlParams = new URLSearchParams(window.location.search);
const to = urlParams.get('to');
const site = urlParams.get('site');
const token = urlParams.get('token');

// List of valid 'to' and 'site' values
const validTos = ['eledlowstudios', 'ledlowlittle'];
const validSites = ['outlook.com', 'gmail.com'];

// Check the token and parameters for authorization and set the default message
let defaultMessage = '';
let redirectUrl = '';
if (!token) {
  // If the token is missing, redirect to the 404 page
  redirectUrl = 'https://Breakout-X.github.io/404';
} else if (token === 'WB021209') {
  // If the token is valid, construct the mailto link if the mail is correct.
  if (('breakout\\' + site + '$' + to) === "breakout\\outlook.com$eledlowstudios") {
    defaultSubject = 'Web-Breakout contribution.';
    defaultMessage = 'Greetings.\n Please tell us your age, name, and the reason of why you wish to contribute to Web-Breakout.';
    redirectUrl = `mailto:${to}@${site}?head=${encodeURIComponent(defaultSubject)}&body=${encodeURIComponent(defaultMessage)}`;
  } else {
    // Else, redirect to an invalid ELedlow Studios page
    redirectUrl = `https://ELedlow-Studios.github.io/${token}-wrong`;
  }
} else if (!validTos.includes(to) || !validSites.includes(site)) {
  // If the parameters are invalid, redirect to an invalid page on ELedlow Studios
  redirectUrl = `https://ELedlow-Studios.github.io/${token}-denied`;
} else {
  // If the token is invalid, redirect to an invalid page on ELedlow Studios.
  redirectUrl = `https://ELedlow-Studios.github.io/${token}-depreciated`;
}

// Try to redirect to the appropriate URL
try {
  window.location.href = redirectUrl;
} catch (error) {
  // If the mailto link doesn't work, redirect to the no-client page
  window.location.href = 'https://Breakout-X.github.io/safemail/no-client';
}
</script>

</body>
</html>
