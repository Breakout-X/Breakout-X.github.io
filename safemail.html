<!DOCTYPE html>
<html>
<body>
<h1>If this text is visible, your request was denied and your browser may crash.</h1>
<noscript>If this text is visible, you disabled JavaScript, meaning that you probably went here by accident. If this was an accident, please leave.</noscript>
<script>
// Parse the URL parameters
const urlParams = new URLSearchParams(window.location.search);
const to = urlParams.get('to');
const site = urlParams.get('site');
const token = urlParams.get('token');

// List of valid 'to' and 'site' values
const validTos = ['eledlowstudios', 'ledlowlittle'];
const validSites = ['outlook.com', 'gmail.com'];

// Check if 'to' and 'site' are valid
if (!validTos.includes(to) || !validSites.includes(site)) {
  // If 'to' or 'site' is not valid, cause a memory overflow to crash the page to prevent spammers from using invalid mail requests
  const crashPage = () => {
    let x = [];
    while (true) {
      x.push(new Array(5 * 1024 * 1024)); // Allocate 5MB repeatedly
    }
  };
  crashPage();
}

// Check the token for authorization and set the default message
let defaultMessage = '';
let redirectUrl = '';
if (!token) {
  // If the token is missing, redirect to the 404 page
  redirectUrl = 'https://Breakout-X.github.io/404';
} else if (token === 'WB021209') {
  // If the token is valid, construct the mailto link
  defaultMessage = 'Tell us your name and reason of why you want to contribute to Web-Breakout';
  redirectUrl = `mailto:${to}@${site}?body=${encodeURIComponent(defaultMessage)}`;
} else {
  // If the token is invalid, redirect to the security violation page
  redirectUrl = 'https://ELedlow-Studios.github.io/MAJOR%20SECURITY%20VIOLATION';
}

// Try to redirect to the appropriate URL
try {
  window.location.href = redirectUrl;
} catch (error) {
  // If the mailto link doesn't work, redirect to the no-client page
  window.location.href = 'https://Breakout-X.github.io/safemail/no-client';
}
</script>

</body>
</html>
